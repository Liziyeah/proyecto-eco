<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rock & Sync</title>
</head>
<body>
    <div id="app">
        
    </div>
    <script src="https://cdn.socket.io/4.8.1/socket.io.min.js"></script>
    <script type="module" src="app.js"></script>
</body>
</html> -->

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Rock & Sync - Mobile</title>
    </head>
    <body>
        <div class="room-info">
            <h2>Rock & Sync</h2>
            <p>Room ID: <span id="roomId"></span></p>
            <div id="connectionStatus" class="status-badge status-disconnected">
                Connecting...
            </div>
        </div>

        <div id="errorMessage" class="error-message" style="display: none">
            Room is full! Please try another room.
        </div>

        <script
            src="https://cdn.socket.io/4.8.1/socket.io.min.js"
            integrity="sha384-mkQ3/7FUtcGyoppY6bz/PORYoGqOl7/aSUMn2ymDOJcapfS6PHqxhRTMh1RR0Q6+"
            crossorigin="anonymous"
        ></script>
        <script>
            // Get room ID from URL
            const params = new URLSearchParams(window.location.search);
            const roomId = params.get('roomId');

            if (!roomId) {
                document.body.innerHTML =
                    '<div class="error-message">Error: No room ID provided</div>';
            } else {
                // Display room ID
                document.getElementById('roomId').textContent = roomId;

                // Connect to Socket.IO
                const socket = io({
                    path: '/real-time',
                });

                socket.on('connect', () => {
                    console.log('Connected to server');
                    const connectionStatus =
                        document.getElementById('connectionStatus');
                    connectionStatus.textContent = 'Connected';
                    connectionStatus.className =
                        'status-badge status-connected';

                    // Join the room as mobile client
                    socket.emit('join-room', {
                        roomId: roomId,
                        type: 'mobile',
                    });
                });

                socket.on('room-full', () => {
                    console.log('Room is full');
                    document.getElementById('errorMessage').style.display =
                        'block';
                    document.getElementById('controlArea').style.display =
                        'none';
                });

                socket.on('disconnect', () => {
                    console.log('Disconnected from server');
                    const connectionStatus =
                        document.getElementById('connectionStatus');
                    connectionStatus.textContent = 'Disconnected';
                    connectionStatus.className =
                        'status-badge status-disconnected';
                });
            }
        </script>
    </body>
</html>
